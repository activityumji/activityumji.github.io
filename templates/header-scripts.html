{# Common scripts in header #}
<script>
	const GLOBAL_CONFIG = {
		root: '/',
		algolia: undefined,
		localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
		translate: undefined,
		noticeOutdate: undefined,
		highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
		copy: {
			success: '复制成功',
			error: '复制错误',
			noSupport: '浏览器不支持'
		},
		relativeDate: {
			homepage: false,
			post: false
		},
		runtime: '',
		date_suffix: {
			just: '刚刚',
			min: '分钟前',
			hour: '小时前',
			day: '天前',
			month: '个月前'
		},
		copyright: undefined,
		lightbox: 'fancybox',
		Snackbar: undefined,
		source: {
			justifiedGallery: {
				js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
				css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
			}
		},
		isPhotoFigcaption: false,
		islazyload: false,
		isAnchor: false
	}
</script>
<script id="config-diff">
	var GLOBAL_CONFIG_SITE = {
        title: '{{ title }}',
		isPost: false,
		isHome: true,
		isHighlightShrink: false,
		isToc: false,
        postUpdate: '{{ update_date }}'
	}
</script>
<noscript>
	<style type="text/css">
		#nav {
			opacity: 1
		}
		.justified-gallery img {
			opacity: 1
		}

		#recent-posts time,
		#post-meta time {
			display: inline !important
		}
	</style>
</noscript>
<script>
	(win=>{
		win.saveToLocal = {
			set: function setWithExpiry(key, value, ttl) {
				if (ttl === 0) return
				const now = new Date()
				const expiryDay = ttl * 86400000
				const item = {
					value: value,
					expiry: now.getTime() + expiryDay,
				}
				localStorage.setItem(key, JSON.stringify(item))
			},

			get: function getWithExpiry(key) {
				const itemStr = localStorage.getItem(key)

				if (!itemStr) {
					return undefined
				}
				const item = JSON.parse(itemStr)
				const now = new Date()

				if (now.getTime() > item.expiry) {
					localStorage.removeItem(key)
					return undefined
				}
				return item.value
			}
		}

		win.getScript = url => new Promise((resolve, reject) => {
			const script = document.createElement('script')
			script.src = url
			script.async = true
			script.onerror = reject
			script.onload = script.onreadystatechange = function() {
				const loadState = this.readyState
				if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
				script.onload = script.onreadystatechange = null
				resolve()
			}
			document.head.appendChild(script)
		})

		win.activateDarkMode = function () {
			document.documentElement.setAttribute('data-theme', 'dark')
			if (document.querySelector('meta[name="theme-color"]') !== null) {
				document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
			}
		}
		win.activateLightMode = function () {
			document.documentElement.setAttribute('data-theme', 'light')
			if (document.querySelector('meta[name="theme-color"]') !== null) {
				document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
			}
		}
		const t = saveToLocal.get('theme')

		if (t === 'dark') activateDarkMode()
		else if (t === 'light') activateLightMode()

		const detectApple = () => {
			if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
				document.documentElement.classList.add('apple')
			}
		}
		detectApple()
	})(window)
</script>
<link rel="shortcut icon" href="/img/favicon.png">
<link rel="canonical" href="https://activityumji.github.io{{ path }}">
<link rel="preconnect" href="//cdn.jsdelivr.net" />
<link rel="preconnect" href="//busuanzi.ibruce.info" />
<link rel="stylesheet" href="/css/index.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'">
